ЗАДАНИЕ 1.1
Выберите базу WORLD. Для этого нажмите правой кнопкой мыши по базе и выберите пункт “Set as Default Schema”.
1. Напишите запрос на создание таблицы АВТОМОБИЛЬ со следующими столбцами:
Наименование столбца Тип Значение по умолчанию Ограничения целостности
Гос_номер CHAR(6) PRIMARY KEY
Марка VARCHAR(20)
Модель VARCHAR(50)
Цена INT BETWEEN 10000 AND 1000000
Категория VARCHAR(15) Легковой IN (Легковой, Грузовой)
Цвет VARCHAR(15)
2. Поочередно напишите и выполните следующие запросы:
2.1. Добавьте столбец ‘Состояние’ типа CHAR(11) с ограничениям целостности IN (‘Новая’, ‘Подержанная’) и NOT NULL со значением по умолчанию ‘Новая’;
2.2. Измените значение по умолчанию столбца Состояние на ‘Подержанная’;
2.3. Удалите столбец Состояние;
3. Поочередно напишите и выполните следующие запросы:
3.1. Добавьте в таблицу АВТОМОБИЛЬ следующие данные:
а086аа Лада Гранта 200000 DEFAULT Чёрный
б871бб MAN X8-2 350000 Грузовой Белый
в351вв Peugeot SportXL 602000 Легковой Зелёный
г112гг Porsche 356B 999999 Легковой Кремовый
4. Поочередно напишите и выполните следующие запросы:
4.1. Обновите цены на все автомобили, уменьшив их в 2 раза;
4.2. Измените текущий цвет чёрных на красный;
4.3. Обновите цены автомобилей в соответствие с условием: если цена > 300000, то уменьшите её в 2 раза, иначе увеличьте в 2 раза. Для реализации запроса используйте конструкцию CASE.
5. Удалите строки из таблицы АВТОМОБИЛЬ, содержащих информацию о легковых автомобилях.
6. Удалите таблицу АВТОМОБИЛЬ из базы данных.

ЗАДАНИЕ 1.2
Создать таблицу по скриншотам и добавить внешний ключ.

ЗАДАНИЕ 1.3
1. Отобразить все данные таблицы CITY;
2. Отобразить названия городов с кодом страны (CountryCode) BRA из таблицы CITY;
3. Отобразить названия и численность населения городов, численность населения (Population) которых превышает 9 000 000 человек из таблицы CITY;
II. Выберите базу SAKILA.
1. Отобразить payment_id, amount, customer_id с сортировкой по убыванию по столбцу amount из таблицы PAYMENT;
2. Отобразить payment_id, amount, customer_id с сортировкой по возрастанию по столбцу amount из таблицы PAYMENT;
3. Отобразить все данные об актерах из таблицы ACTOR чьё имя (first_name) ‘JOHN’ или ‘JOHNNY’;
4. *Отобразить все данные об актерах из таблицы ACTOR чьё имя (first_name) ‘JOHN’ или ‘JOHNNY’, но фамилия (last_name) не ‘CAGE’;
III. Выберите базу WORLD.
1. Отобразить Code, Name, Region таблицы COUNTRY в строке которых значение IndepYear равно NULL;
2. Отобразить Code, Name, Region таблицы COUNTRY в строке которых значение IndepYear не равно NULL;
3. Отобразите названия стран (Name) таблицы COUNTRY, находящихся в Европе (Continent). Результирующий столбец назовите ‘Европа’ при помощи оператора AS;
4. Отобразить названия стран (Name) таблицы COUNTRY, площадь которых (SurfaceArea) находится в диапазоне между 200 000 и 250 000. Для реализации запросы используйте конструкцию BETWEEN;
IV. Выберите базу SAKILA.
1. *Отобразить названия (title) фильмов-драм из таблицы FILM. Для написания запроса используйте оператор LIKE, чтобы в поле Description найти слово ‘Drama’. Результирующий столбец выведите как ‘Драма’ при помощи оператора AS.

ЗАДАНИЕ 1.4
1. Из таблицы PAYMENT отобразите сумму всех оплат (amount) для каждого клиента (customer_id). В первом столбце выведите ID клиента с именем столбца ‘Клиент’, а во втором столбце сумму его оплат с именем столбца ‘Всего’;
2. Из таблицы PAYMENT отобразите количество проведенных оплат для каждого сотрудника (staff_id). В первом столбце выведите ID сотрудника с именем столбца ‘Сотрудник, а во втором столбце количество его заказов с именем столбца ‘Всего оплат’;
3. Напишите запрос с подзапросом. Отобразите ID клиентов (customer_id) из таблицы CUSTOMER, где ID клиента равен всем записям подзапроса на выборку ID клиентов, имеющих значение rental_id равное 4219 в таблице PAYMENT. Результирующий столбец назовите ‘Особые клиенты’. Макет запроса: SELECT attr FROM table_1 WHERE attr = ALL (SELECT attr FROM table_2 WHERE attr_2 = number);
4. Напишите запрос с подзапросом. Отобразите ID актеров (actor_id) из таблицы ACTOR, снявшихся в фильме с film_id, равным 1 в таблице FILM_ACTOR. Результирующий столбец назовите ‘В фильме 1 снимались’. Макет запроса: аналогичен предыдущему, но вместо функции ALL() используйте функцию ANY();
5. Отобразите имена (first_name) и фамилии (last_name) актеров из таблицы ACTOR, среди которых встречаются имена: JOHNNY, NICK, JULIA. Для реализации запроса используйте конструкцию IN.
II. Выберите базу WORLD.
1. Из таблицы COUNTRY отобразите названия континентов, содержащих более 50 стран. В первом столбце выведите название континента (Continent), а во втором количество стран, которые на нем находятся. Для реализации запроса используйте оператор HAVING.
